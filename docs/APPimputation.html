<!DOCTYPE html>
<html lang="en" xml:lang="en">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>B Completing the status updates streams for transplant recipients | Organ allocation models in Eurotransplant</title>
  <meta name="description" content="This is the PhD thesis of H.C. de Ferrante" />
  <meta name="generator" content="bookdown 0.42 and GitBook 2.6.7" />

  <meta property="og:title" content="B Completing the status updates streams for transplant recipients | Organ allocation models in Eurotransplant" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/cover/thesis_cover.png" />
  <meta property="og:description" content="This is the PhD thesis of H.C. de Ferrante" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="B Completing the status updates streams for transplant recipients | Organ allocation models in Eurotransplant" />
  
  <meta name="twitter:description" content="This is the PhD thesis of H.C. de Ferrante" />
  <meta name="twitter:image" content="/cover/thesis_cover.png" />

<meta name="author" content="Hans Christiaan de Ferrante" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="APPipcw.html"/>
<link rel="next" href="summary.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>



<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="" data-path="dankwoord.html"><a href="dankwoord.html"><i class="fa fa-check"></i>Dankwoord</a></li>
<li class="chapter" data-level="1" data-path="CHintroduction.html"><a href="CHintroduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="CHintroduction.html"><a href="CHintroduction.html#eurotransplant"><i class="fa fa-check"></i><b>1.1</b> Eurotransplant</a></li>
<li class="chapter" data-level="1.2" data-path="CHintroduction.html"><a href="CHintroduction.html#objective-medical-criteria-for-organ-allocation"><i class="fa fa-check"></i><b>1.2</b> Objective medical criteria for organ allocation</a></li>
<li class="chapter" data-level="1.3" data-path="CHintroduction.html"><a href="CHintroduction.html#fairness-in-organ-allocation"><i class="fa fa-check"></i><b>1.3</b> Fairness in organ allocation</a></li>
<li class="chapter" data-level="1.4" data-path="CHintroduction.html"><a href="CHintroduction.html#challenges-in-improving-organ-allocation-systems"><i class="fa fa-check"></i><b>1.4</b> Challenges in improving organ allocation systems</a></li>
<li class="chapter" data-level="1.5" data-path="CHintroduction.html"><a href="CHintroduction.html#outline-of-this-thesis"><i class="fa fa-check"></i><b>1.5</b> Outline of this thesis</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="CHprefaceliver.html"><a href="CHprefaceliver.html"><i class="fa fa-check"></i><b>2</b> Liver allocation in Eurotransplant</a>
<ul>
<li class="chapter" data-level="2.1" data-path="CHprefaceliver.html"><a href="CHprefaceliver.html#liver-allocation-prior-to-meld"><i class="fa fa-check"></i><b>2.1</b> Liver allocation prior to MELD</a></li>
<li class="chapter" data-level="2.2" data-path="CHprefaceliver.html"><a href="CHprefaceliver.html#meld-based-liver-allocation-in-the-united-states"><i class="fa fa-check"></i><b>2.2</b> MELD-based liver allocation in the United States</a></li>
<li class="chapter" data-level="2.3" data-path="CHprefaceliver.html"><a href="CHprefaceliver.html#meld-based-liver-allocation-in-eurotransplant"><i class="fa fa-check"></i><b>2.3</b> MELD-based liver allocation in Eurotransplant</a></li>
<li class="chapter" data-level="2.4" data-path="CHprefaceliver.html"><a href="CHprefaceliver.html#areas-for-improvement-in-meld-based-allocation-systems"><i class="fa fa-check"></i><b>2.4</b> Areas for improvement in MELD-based allocation systems</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="CHdynremeld.html"><a href="CHdynremeld.html"><i class="fa fa-check"></i><b>3</b> Revising MELD from calendar-time cross-sections with correction for selection bias</a>
<ul>
<li class="chapter" data-level="3.1" data-path="CHdynremeld.html"><a href="CHdynremeld.html#introduction"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="CHdynremeld.html"><a href="CHdynremeld.html#materials-and-methods"><i class="fa fa-check"></i><b>3.2</b> Materials and methods</a></li>
<li class="chapter" data-level="3.3" data-path="CHdynremeld.html"><a href="CHdynremeld.html#results"><i class="fa fa-check"></i><b>3.3</b> Results</a></li>
<li class="chapter" data-level="3.4" data-path="CHdynremeld.html"><a href="CHdynremeld.html#discussion"><i class="fa fa-check"></i><b>3.4</b> Discussion</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="CHsexdisparity.html"><a href="CHsexdisparity.html"><i class="fa fa-check"></i><b>4</b> Sex disparity in liver allocation within Eurotransplant</a>
<ul>
<li class="chapter" data-level="4.1" data-path="CHsexdisparity.html"><a href="CHsexdisparity.html#introduction-1"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="CHsexdisparity.html"><a href="CHsexdisparity.html#materials-and-methods-1"><i class="fa fa-check"></i><b>4.2</b> Materials and methods</a></li>
<li class="chapter" data-level="4.3" data-path="CHsexdisparity.html"><a href="CHsexdisparity.html#results-1"><i class="fa fa-check"></i><b>4.3</b> Results</a></li>
<li class="chapter" data-level="4.4" data-path="CHsexdisparity.html"><a href="CHsexdisparity.html#discussion-1"><i class="fa fa-check"></i><b>4.4</b> Discussion</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="CHelassimulator.html"><a href="CHelassimulator.html"><i class="fa fa-check"></i><b>5</b> The ELAS simulator</a>
<ul>
<li class="chapter" data-level="5.1" data-path="CHelassimulator.html"><a href="CHelassimulator.html#introduction-2"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="CHelassimulator.html"><a href="CHelassimulator.html#sec:elassystem"><i class="fa fa-check"></i><b>5.2</b> The Eurotransplant Liver Allocation System (ELAS)</a></li>
<li class="chapter" data-level="5.3" data-path="CHelassimulator.html"><a href="CHelassimulator.html#sec:elasdesign"><i class="fa fa-check"></i><b>5.3</b> The design of the ELAS simulator</a></li>
<li class="chapter" data-level="5.4" data-path="CHelassimulator.html"><a href="CHelassimulator.html#sec:elasmodules"><i class="fa fa-check"></i><b>5.4</b> Modules of the ELAS simulator</a></li>
<li class="chapter" data-level="5.5" data-path="CHelassimulator.html"><a href="CHelassimulator.html#sec:elasvv"><i class="fa fa-check"></i><b>5.5</b> Verification and validation</a></li>
<li class="chapter" data-level="5.6" data-path="CHelassimulator.html"><a href="CHelassimulator.html#sec:elascasestudies"><i class="fa fa-check"></i><b>5.6</b> Case studies: the impact of modifying ELAS rules</a></li>
<li class="chapter" data-level="5.7" data-path="CHelassimulator.html"><a href="CHelassimulator.html#sec:elasconclusion"><i class="fa fa-check"></i><b>5.7</b> Conclusions and discussion</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="CHprefacekidney.html"><a href="CHprefacekidney.html"><i class="fa fa-check"></i><b>6</b> Kidney allocation in Eurotransplant</a>
<ul>
<li class="chapter" data-level="6.1" data-path="CHprefacekidney.html"><a href="CHprefacekidney.html#hla-matching-versus-fairness"><i class="fa fa-check"></i><b>6.1</b> HLA matching versus fairness</a></li>
<li class="chapter" data-level="6.2" data-path="CHprefacekidney.html"><a href="CHprefacekidney.html#kidney-allocation-programs-in-eurotransplant"><i class="fa fa-check"></i><b>6.2</b> Kidney allocation programs in Eurotransplant</a></li>
<li class="chapter" data-level="6.3" data-path="CHprefacekidney.html"><a href="CHprefacekidney.html#contemporary-challenges-in-kidney-allocation"><i class="fa fa-check"></i><b>6.3</b> Contemporary challenges in kidney allocation</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="CHvpra.html"><a href="CHvpra.html"><i class="fa fa-check"></i><b>7</b> Access to transplantation for immunized candidates</a>
<ul>
<li class="chapter" data-level="7.1" data-path="CHvpra.html"><a href="CHvpra.html#introduction-3"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="CHvpra.html"><a href="CHvpra.html#materials-and-methods-2"><i class="fa fa-check"></i><b>7.2</b> Materials and methods</a></li>
<li class="chapter" data-level="7.3" data-path="CHvpra.html"><a href="CHvpra.html#results-2"><i class="fa fa-check"></i><b>7.3</b> Results</a></li>
<li class="chapter" data-level="7.4" data-path="CHvpra.html"><a href="CHvpra.html#discussion-2"><i class="fa fa-check"></i><b>7.4</b> Discussion</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="CHetkidneysimulator.html"><a href="CHetkidneysimulator.html"><i class="fa fa-check"></i><b>8</b> The ETKidney simulator</a>
<ul>
<li class="chapter" data-level="8.1" data-path="CHetkidneysimulator.html"><a href="CHetkidneysimulator.html#introduction-4"><i class="fa fa-check"></i><b>8.1</b> Introduction</a></li>
<li class="chapter" data-level="8.2" data-path="CHetkidneysimulator.html"><a href="CHetkidneysimulator.html#sec:etkidneyalloc"><i class="fa fa-check"></i><b>8.2</b> The kidney allocation programs of Eurotransplant</a></li>
<li class="chapter" data-level="8.3" data-path="CHetkidneysimulator.html"><a href="CHetkidneysimulator.html#sec:etkidneydesign"><i class="fa fa-check"></i><b>8.3</b> Purpose and design of the ETKidney Simulator</a></li>
<li class="chapter" data-level="8.4" data-path="CHetkidneysimulator.html"><a href="CHetkidneysimulator.html#sec:etkidneymodules"><i class="fa fa-check"></i><b>8.4</b> Modules of the ETKidney simulator</a></li>
<li class="chapter" data-level="8.5" data-path="CHetkidneysimulator.html"><a href="CHetkidneysimulator.html#sec:etkidneyvv"><i class="fa fa-check"></i><b>8.5</b> Verification and validation</a></li>
<li class="chapter" data-level="8.6" data-path="CHetkidneysimulator.html"><a href="CHetkidneysimulator.html#sec:etkidneycasestudies"><i class="fa fa-check"></i><b>8.6</b> Case studies</a></li>
<li class="chapter" data-level="8.7" data-path="CHetkidneysimulator.html"><a href="CHetkidneysimulator.html#sec:etkidneydiscussion"><i class="fa fa-check"></i><b>8.7</b> Discussion and conclusion</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="CHdiscussion.html"><a href="CHdiscussion.html"><i class="fa fa-check"></i><b>9</b> The way forward</a>
<ul>
<li class="chapter" data-level="9.1" data-path="CHdiscussion.html"><a href="CHdiscussion.html#this-thesis-is-a-sharp-look-at-familiar-problems"><i class="fa fa-check"></i><b>9.1</b> This thesis is a sharp look at familiar problems</a></li>
<li class="chapter" data-level="9.2" data-path="CHdiscussion.html"><a href="CHdiscussion.html#we-need-to-look-beyond-survival-models-for-allocation"><i class="fa fa-check"></i><b>9.2</b> We need to look beyond survival models for allocation</a></li>
<li class="chapter" data-level="9.3" data-path="CHdiscussion.html"><a href="CHdiscussion.html#we-should-look-beyond-aggregate-outcomes"><i class="fa fa-check"></i><b>9.3</b> We should look beyond aggregate outcomes</a></li>
<li class="chapter" data-level="9.4" data-path="CHdiscussion.html"><a href="CHdiscussion.html#scientific-evidence-is-rarely-the-bottleneck"><i class="fa fa-check"></i><b>9.4</b> Scientific evidence is rarely the bottleneck</a></li>
<li class="chapter" data-level="9.5" data-path="CHdiscussion.html"><a href="CHdiscussion.html#the-chicken-and-egg-problem-in-allocation-development"><i class="fa fa-check"></i><b>9.5</b> The “chicken-and-egg” problem in allocation development</a></li>
<li class="chapter" data-level="9.6" data-path="CHdiscussion.html"><a href="CHdiscussion.html#we-need-more-constructive-dialogue"><i class="fa fa-check"></i><b>9.6</b> We need more constructive dialogue</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="APPipcw.html"><a href="APPipcw.html"><i class="fa fa-check"></i><b>A</b> Inverse Probability Censoring Weights</a>
<ul>
<li class="chapter" data-level="" data-path="APPipcw.html"><a href="APPipcw.html#definition-of-ipcw-weights"><i class="fa fa-check"></i>Definition of IPCW weights</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="APPimputation.html"><a href="APPimputation.html"><i class="fa fa-check"></i><b>B</b> Completing the status updates streams for transplant recipients</a>
<ul>
<li class="chapter" data-level="B.1" data-path="APPimputation.html"><a href="APPimputation.html#step-1-and-2-construction-of-the-pseudo-observations"><i class="fa fa-check"></i><b>B.1</b> Step 1 and 2: Construction of the pseudo-observations</a></li>
<li class="chapter" data-level="B.2" data-path="APPimputation.html"><a href="APPimputation.html#step-3-fitting-a-model-for-the-mean-restricted-survival-time"><i class="fa fa-check"></i><b>B.2</b> Step 3: Fitting a model for the mean restricted survival time</a></li>
<li class="chapter" data-level="B.3" data-path="APPimputation.html"><a href="APPimputation.html#step-4-constructing-future-statuses"><i class="fa fa-check"></i><b>B.3</b> Step 4: Constructing future statuses</a></li>
<li class="chapter" data-level="B.4" data-path="APPimputation.html"><a href="APPimputation.html#step-4.2-matching-the-patient-to-a-particular-patient-in-the-risk-set"><i class="fa fa-check"></i><b>B.4</b> Step 4.2: Matching the patient to a particular patient in the risk set</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i>Summary</a></li>
<li class="chapter" data-level="" data-path="course-of-life.html"><a href="course-of-life.html"><i class="fa fa-check"></i>Course of Life</a></li>
<li class="chapter" data-level="" data-path="list-of-publications.html"><a href="list-of-publications.html"><i class="fa fa-check"></i>List of publications</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Organ allocation models in Eurotransplant</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="APPimputation" class="section level1 hasAnchor" number="11">
<h1><span class="header-section-number">B</span> Completing the status updates streams for transplant recipients<a href="APPimputation.html#APPimputation" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p></p>
<p>The ELAS and ETKidney simulators require complete streams of status updates
to be available for all patient registrations, which means that every registration
must end with a waiting list removal (R) or death (D). However, most kidney or
liver candidates are transplanted, making these endpoints – and any status
that would have occurred between transplantation and candidate death or removal –
unobserved. This is a general problem faced for the development of
discrete-event simulators for organ allocation. The SAM simulators address
it by matching transplant recipients to not-yet-transplanted patients based
on their predicted remaining lifetime, with remaining life time predicted using
a standard Cox model <span class="citation"><a href="#ref-SRTR2019">[96]</a></span>. However, this
approach does address for repeated measures, does not match on other relevant
characteristics that might affect a candidate’s health status trajectory (such as
disease group), and also does not correct for informative censoring from
transplantation, which can bias mortality estimates.</p>
<p>To address these limitations, we modify an existing statistical procedure from <span class="citation"><a href="#ref-tayobstatistical2017">[195]</a></span> to complete the status update streams for patient
registrations in the ELAS and ETKidney simulators. This procedure constructs for every transplant recipient <span class="math inline">\(i\)</span> a risk set of
<span class="math inline">\(R_i\)</span> of not-yet-transplanted patients, who (a) have similar covariate profiles as patient <span class="math inline">\(i\)</span> and (b)
have similar predicted remaining survival, where remaining survival is predicted
using methodology that accounts for repeated measures and corrects for informative
censoring. Algorithm B.1 summarizes this procedure. Steps 1 to 2 construct pseudo-observations for the expected log remaining survival time,
and Step 3 fits a model for log survival as a function of covariates.
These steps are performed once on the full cohort to estimate model
coefficients (<span class="math inline">\(\beta^{\text{PO}}\)</span>). Step 4 is iteratively applied for each
transplant recipient, until their registration ends with a waiting list death (D)
or waiting list removal (R).</p>
<p><img src="figures/appendix/flowchart.svg" width="100%" style="display: block; margin: auto;" /></p>
<div id="summary-of-tayob-and-murray-2017" class="section level4 unnumbered hasAnchor">
<h4>Summary of Tayob and Murray (2017)<a href="APPimputation.html#summary-of-tayob-and-murray-2017" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Algorithm B.1 uses statistical methodology developed by <span class="citation"><a href="#ref-tayobstatistical2017">[195]</a></span>.
Tayob and Murray aim to model the 12-month restricted survival time <span class="math inline">\(T^* = \min(T, \tau)\)</span>
of lung transplant candidates from pre-determined, regularly spaced landmark
times <span class="math inline">\(j = 1, ..., J\)</span>. To this end, they define
<span class="math inline">\(T^*_{ij}\)</span> as the <span class="math inline">\(\tau\)</span>-restricted remaining survival time of subject
<span class="math inline">\(i\)</span> from landmark time <span class="math inline">\(j\)</span>, and use <span class="math inline">\(\tau = 12\)</span> months in their application.
The central goal of their paper is to estimate
the expected log-survival time conditional on covariates, i.e. to model
<span class="math display">\[\mathbb{E}[\log(T^*) | Z] = \beta^\intercal Z.\]</span></p>
<p>They face three statistical challenges in the estimation of this model:</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(T^*_{ij}\)</span> is unobserved for most candidates due to censoring,</li>
<li>transplantation represents an informative censoring mechanism,</li>
<li>the <span class="math inline">\(T^*_{ij}\)</span>s exhibit within-patient correlations across the landmark times <span class="math inline">\(j\)</span>.</li>
</ol>
<p>To address these challenges, Tayob and Murray proceed as follows:</p>
<ol style="list-style-type: decimal">
<li><p>Tayob and Murray construct for each censored <span class="math inline">\(T^*_{ij}\)</span> a risk set <span class="math inline">\(R_i\)</span> of
individuals who are (a) uncensored, (b) have similar expected survival
as candidate <span class="math inline">\(i\)</span>, and (c) have similar covariates as patient <span class="math inline">\(i\)</span>. They construct
these risk sets by following steps 1 through 4.1 of Algorithm B.1. In
constructing these risk sets, Tayob and Murray require candidates to
have similar covariate profiles to ensure that patients in the risk set are
comparable despite the substantial heterogeneity of patients on the waiting
list for lung transplantation. After step 4.1 of Algorithm B.1, Tayob and Murray derive
<span class="math inline">\(M=10\)</span> imputes of <span class="math inline">\(T^*_{ij}\)</span> by inverse transform sampling from the risk-set
specific survival function <span class="math inline">\(S^{\text{IPCW}}(t|R_i)\)</span>. They then use these
imputes to fit the model
<span class="math inline">\(\mathbb{E}[\log(T^*) | Z] = \beta^\intercal Z\)</span>, with
coefficients pooled using Rubin’s rules.</p></li>
<li><p>they use inverse probability censoring weighting (IPCW) to correct for informative
censoring by transplantation in estimating the survival function in step 1 and step 4.2.</p></li>
<li><p>In estimating <span class="math inline">\(\mathbb{E}[\log(T^*)|Z] = \beta^\intercal Z\)</span> in
step 3 (and in their final step), Tayob and Murray address the
within-patient correlations by fitting the model with
Generalized Estimating Equations (GEE) with an unstructured
working correlation matrix. This approach yields consistent
estimates of <span class="math inline">\(\beta\)</span> if the model is correctly specified (the
correlation structure is allowed to be misspecified).</p></li>
</ol>
<p>Tayob and Murray conduct extensive statistical simulations to show that their
procedure can indeed estimate <span class="math inline">\(\mathbb{E}[\log(T^*) | Z] = \beta^\intercal Z\)</span> with
minimal bias, and with similar efficiency to estimates obtained if censoring had never
occurred.</p>
<p></p>
</div>
<div id="overview-of-the-counterfactual-future-status-imputation-procedure" class="section level4 unnumbered hasAnchor">
<h4>Modifications to Tayob and Murray’s procedure for Algorithm B.1.<a href="APPimputation.html#overview-of-the-counterfactual-future-status-imputation-procedure" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Tayob and Murray thus construct for every transplant recipient <span class="math inline">\(i\)</span> a risk set
<span class="math inline">\(R_i\)</span> of comparable patients, and use this risk set to sample imputes
for <span class="math inline">\(T^*_{ij}\)</span>. Our goal is to construct such a risk set <span class="math inline">\(R_i\)</span>, and use this
risk set to match candidate <span class="math inline">\(i\)</span> to a
specific candidate <span class="math inline">\(k \in R_i\)</span>, who has similar remaining life time and covariates.
To achieve this, Algorithm B.1 has the following deviations from Tayob and Murray:</p>
<ul>
<li><p>Tayob and Murray only match censored candidates to non-censored candidates
at specific landmark times <span class="math inline">\(j = 1, ..., J\)</span>. To enable discrete-event
simulations, we must match transplant recipients to not-yet-transplanted
candidates at the actual time of each transplant recipient’s last known
status update, which we denote by <span class="math inline">\(t\)</span>. The set of <span class="math inline">\(t\)</span> is fully
determined by the observed data, as the timings at which a
candidate reports status update are not set by Eurotransplant.
We define <span class="math inline">\(T^*_{it}\)</span> as the restricted
remaining survival time measured from <span class="math inline">\(t\)</span> onwards, and construct
pseudo-observations <span class="math inline">\(PO_{it}\)</span> for the log restricted remaining survival time
at time <span class="math inline">\(t\)</span>. This is done by steps 1 and 2 of Algorithm B.1.</p></li>
<li><p>The time points <span class="math inline">\(t\)</span> correspond to any moment at which a candidate has
reported a status update, and are therefore irregularly spaced and
patient-specific. Because this makes the number of time points large, estimation of
<span class="math inline">\(\beta^{\text{PO}}\)</span> in step 3 using GEE with an unstructured working
correlation matrix is infeasible. Instead, we estimate
<span class="math inline">\(\beta^\text{PO}\)</span> with Quasi-Least Squares (QLS) with a Markov correlation structure
<span class="citation"><a href="#ref-xieqls2010">[196]</a></span>. This structure assumes that the within-patient correlations
between the pseudo-observations <span class="math inline">\(PO_{it}\)</span> decay with their spacing in <span class="math inline">\(t\)</span>.</p></li>
<li><p>After step 4.2, Tayob and Murray use inverse-transform sampling from the
risk-set-specific survival function <span class="math inline">\(S^{\text{IPCW}}(t|R_i)\)</span> to sample imputes for
<span class="math inline">\(T^*_{ij}\)</span>. We instead use inverse-transform sampling from <span class="math inline">\(S^{\text{IPCW}}(t|R_i)\)</span>
to match candidate <span class="math inline">\(i\)</span> to a specific candidate <span class="math inline">\(k \in R_i\)</span>. We then copy over
the status updates from patient <span class="math inline">\(k\)</span> to patient <span class="math inline">\(i\)</span>, and
repeat this step until all candidates have status updates that end with a
waiting list removal (R) or (D) (see Step 4.4 of Algorithm B.1).</p></li>
</ul>
<p>In the remainder of this appendix, we describe the steps of Algorithm B.1 in more detail.</p>
<p>For the ELAS simulator, Algorithm B.1 was run separately
for HU and elective candidates, with the time origin of <span class="math inline">\(t\)</span> defined for both
candidate groups as the date a
candidate was listed for transplantation. For the HU model, we used <span class="math inline">\(\tau\)</span>=14 days as the time horizon. For the elective candidates, we used <span class="math inline">\(\tau\)</span>=90 days.</p>
<p>For the ETKidney simulator, Algorithm B.1 was run on all kidney
transplant candidates, with the time origin defined as the dialysis initiation date. A time horizon of 365 days was used (<span class="math inline">\(\tau=365\)</span> days).</p>
<p></p>
</div>
<div id="step-1-and-2-construction-of-the-pseudo-observations" class="section level2 hasAnchor" number="11.1">
<h2><span class="header-section-number">B.1</span> Step 1 and 2: Construction of the pseudo-observations<a href="APPimputation.html#step-1-and-2-construction-of-the-pseudo-observations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="step-1-consistent-estimation-of-the-survival-function" class="section level4 unnumbered hasAnchor">
<h4>Step 1: Consistent estimation of the survival function<a href="APPimputation.html#step-1-consistent-estimation-of-the-survival-function" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Algorithm B.1 requires us to consistently estimate the survival function in Step
1 and Step 4.2. A statistical challenge for this is that we have to deal with
informative censoring by transplantation. To correct for such informative
censoring, we use a Cox
model to predict the probability that a patient is transplanted over time,
and estimate the survival function weighing observations by their inverse probability of being transplanted.</p>
<p>For the ELAS simulator, this censoring model adjusted for recipient sex,
recipient blood group, spline terms of recipient weight and age, recipient
disease group, percentage of time NT (total/too bad/too good), the national
match MELD, whether the patient is on dialysis, whether the patient has a downmarked
MELD score, and whether the patient has an exception (Y/N).</p>
<p>For the ETKidney simulator, this censoring model adjusted for are candidate sex,
candidate blood group, spline terms of candidate age, the disease group (congenital,
polycystic, neoplasms, diabetes, glomerular disease, renovascular / vascular disease,
tubular and interstitial disease, or other), the HLA-ABDR mismatch frequency
(defined in Section <a href="CHetkidneysimulator.html#sec:etkidneymmp">8.4.1.3</a>)</p>
<p>Figure <a href="APPimputation.html#fig:chappsfig2">B.1</a> shows estimated survival functions
without (orange) and with (blue) correction for dependent censoring for
elective liver transplantation patients, stratified by their laboratory MELD score at listing. The estimates of the 90-day survival probabilities decrease
due to
inverse probability weighting, with 90-day waiting list survival
estimated with IPCW up to 7.4% lower for MELD 25–29 than 90-day waiting
list survival estimated without IPCW. This is expected, as candidates who
are deteriorate on the waiting list have a higher probability of being
transplanted on the waiting list.</p>
<p>With these censoring models, we can construct IPCW weights for each patient, based on the predicted probability
of being transplanted at each time point. Using these IPCW weights, we then
estimate the counterfactual survival function with the Kaplan–Meier estimator.
This approach allows us to consistently estimate the survival function under
dependent censoring, as required for step 1 of Algorithm B.1.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:chappsfig2"></span>
<img src="figures/appendix/sfig2-estimated_event_probs.png" alt="Estimated survival probabilities estimated in the cohort, with (blue) and without (orange) Inverse Probability Censoring Weighting to correct for informative censoring by transplantation." width="90%" />
<p class="caption">
Figure B.1: Estimated survival probabilities estimated in the cohort, with (blue) and without (orange) Inverse Probability Censoring Weighting to correct for informative censoring by transplantation.
</p>
</div>
<p></p>
</div>
<div id="step-2-construction-of-pseudo-observations" class="section level4 unnumbered hasAnchor">
<h4>Step 2: Construction of pseudo-observations<a href="APPimputation.html#step-2-construction-of-pseudo-observations" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>To predict the expected remaining lifetime for candidates on the waiting list,
we directly model candidate’s expected residual remaining survival time <span class="math inline">\(T^{*}\)</span> using:
<span class="math display">\[\mathbb{E}[\log(T^*)|Z] = \beta^\intercal Z.\]</span> For this, we
would ideally know the remaining time-to-event <span class="math inline">\(T^*_{it}\)</span> for
all patients <span class="math inline">\(i\)</span> and status update times <span class="math inline">\(t\)</span>. However, censoring and
transplantation within <span class="math inline">\(\tau\)</span> time units of <span class="math inline">\(t\)</span> prevent us from
observing <span class="math inline">\(T^*_{it}\)</span>. Formula (2) of <span class="citation"><a href="#ref-tayobstatistical2017">[195]</a></span> describes
how pseudo-observations for <span class="math inline">\(\log(T_{ij}*)\)</span> can be constructed using
only the survival function <span class="math inline">\(\hat{S}^{\text{IPCW}}(t)\)</span>
that was estimated in Step 1 of Algorithm B.1.
We used this formula to calculate pseudo-observations <span class="math inline">\(PO_{it}\)</span> for
<span class="math inline">\(\log(T^*_{it})\)</span>. Armed with pairs <span class="math inline">\((PO_{it}, Z_i)\)</span>, we can
estimate <span class="math inline">\(\beta^{PO}\)</span> in step 3 of Algorithm B.1.
</p>
</div>
</div>
<div id="step-3-fitting-a-model-for-the-mean-restricted-survival-time" class="section level2 hasAnchor" number="11.2">
<h2><span class="header-section-number">B.2</span> Step 3: Fitting a model for the mean restricted survival time<a href="APPimputation.html#step-3-fitting-a-model-for-the-mean-restricted-survival-time" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>With pairs <span class="math inline">\((PO_{it}, Z_i)\)</span> we can model the expected log remaining
survival time as</p>
<p><span class="math display">\[
\mathbb{E}[\log(T^*) \mid Z] = \beta^\intercal Z
\tag{B.1}
\]</span></p>
<p>A statistical challenge to estimating <span class="math inline">\(\beta\)</span> is that we have
to deal with the within-patient correlations in <span class="math inline">\(PO_{it}\)</span> across
status update times <span class="math inline">\(t\)</span>. Tayob and Murray
faced a similar issue, with correlations between <span class="math inline">\(T^*_{ij}\)</span>
over the landmark times <span class="math inline">\(j\)</span>. They addressed this issue by estimating
<span class="math inline">\(\beta\)</span> with Generalized Estimating Equations (GEE) with an unstructured
correlation matrix correlation over the landmark times <span class="math inline">\(j\)</span> (which
requires <span class="math inline">\(j(j+1)/2\)</span> parameters). This allows for consistent estimation of
<span class="math inline">\(\beta\)</span>, even if the correlation structure is misspecified.</p>
<p>Unfortunately, this specific estimation strategy is not feasible in our setting: in our case, the pseudo-observations <span class="math inline">\(PO_{it}\)</span>
are indexed by <span class="math inline">\(t\)</span>, i.e., all the timings at which candidates reported status
updates to Eurotransplant, which would blow up the dimensions
for an unstructured working correlation matrix. To
estimate the model, we instead estimate
the model with Quasi-Least Squares with a Markov correlation structure <span class="citation"><a href="#ref-Shults2014-di">[197]</a></span>. This Markov correlation
structure assumes that the correlation between measurements
<span class="math inline">\(PO_{is}\)</span> and <span class="math inline">\(PO_{it}\)</span> decays with their separation in time:
<span class="math display">\[\texttt{Corr}(PO_{is}, PO_{it}) = \alpha^{|s-t|}.\]</span> Parameters
<span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> of this model can be estimated with the <code>qlspack</code> R
package <span class="citation"><a href="#ref-xieqls2010">[196]</a></span>. With this approach, <span class="math inline">\(\beta\)</span> can also
be consistently estimated even if the correlation structure is
misspecified.</p>
<p>For the ELAS simulator, we use different model specifications for HU
and elective patients for equation B1. For HU patients, the covariates
include recipient age at registration, the laboratory MELD score, whether the
patient is on biweekly dialysis, recipient sex, and disease group. For
elective patients, we adjust for age at registration, recipient weight,
MELD components (serum creatinine, bilirubin, INR, biweekly dialysis),
recipient sex, disease group, cirrhosis etiology, type of exception
score, whether it is a repeat transplant candidate, and whether the patient
has failed to re-certify their MELD score. Continuous variables are
transformed with spline terms.</p>
<p>For the ETKidney simulator, we use covariates for candidate age, candidate sex,
whether the candidate has previously received a kidney transplantation,
as well as the time the candidate has waited on the kidney waiting list.</p>
<p></p>
</div>
<div id="step-4-constructing-future-statuses" class="section level2 hasAnchor" number="11.3">
<h2><span class="header-section-number">B.3</span> Step 4: Constructing future statuses<a href="APPimputation.html#step-4-constructing-future-statuses" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To complete the set of status updates for transplant recipient <span class="math inline">\(i\)</span>,
we first construct a risk set <span class="math inline">\(R_i\)</span> of not-yet-transplanted candidates who
are comparable to the transplant recipient (step 4.1).
As in Tayob and Murray, a minimum requirement to match transplanted
candidates to not-yet-transplanted candidates is:
<span class="math display">\[|\hat{\beta}^{\text{PO}}\ ^\intercal Z_k(C_{i}) - \hat{\beta}^{\text{PO}}\ ^\intercal Z_i(C_{i})| &lt; 0.50,\]</span>
i.e., candidates have similar expected log restricted survival.</p>
<p>We additionally require candidates to match on other covariates,
as is done by Tayob and Murray. A motivation for requiring candidates to
also match on covariate profiles is that organ waiting lists are highly
heterogeneous, and we want to ascertain that the candidate’s risk set
only consists of patients that are actually comparable to the patient. For example, by matching on disease groups for
liver transplantation candidates, we can prevent that a candidate
with chronic liver cirrhosis is matched to a candidate with hepatocellular
carcinoma, even if these patients have similar predicted remaining
survival time.</p>
<p>For the ELAS simulator, we require candidates to always match on pediatric status. For other discrete and continuous variables, we use an adaptive matching procedure,
in which we strive towards <span class="math inline">\(|R_i|\)</span> = 35 candidates in the risk set for HU patients, and <span class="math inline">\(|R_i|\)</span> = 50
candidates for non-HU patients. Specifically, the discrete variables used for matching are</p>
<ol style="list-style-type: decimal">
<li>whether the patient is a repeat transplant candidate</li>
<li>current urgency code (non-transplantable)</li>
<li>(N)SE group</li>
<li>disease group</li>
<li>urgency reason (NT too good / NT other / NT too bad)</li>
<li>biweekly dialysis (twice in week preceding MELD measurement)</li>
<li>recipient country.</li>
</ol>
<p>Continuous match variables used are the laboratory MELD score, age at
registration, (N)SE MELD score (for elective patients only), where we
restrict absolute differences in continuous variables to pre-determined
caliper widths (lab-MELD: 5, age: 15 years, (N)SE-MELD: 5). In case
matching according to all criteria fails to result in a risk set of
sufficient size, we drop a discrete match criterion (from 7 to 1 in the
list above). In case dropping all discrete match criteria does not
result in adequately sized risk set, we increase caliper widths for
continuous variables. In total, about 50% of transplant recipients can
be matched to a risk set on all characteristics, and 80% of
transplant recipients can be matched on
the first 4 discrete variables (with the most restrictive caliper
widths).</p>
<p>For the ETKidney simulator, we always match candidates on whether they have
had a previous kidney transplantation, as well as whether they have an active
waiting list status. The procedure also tried to match candidates based on disease group, reason why they were non-transplantable, and candidate country of listing. These constraints were relaxed in case fewer than 50 candidates could be
included in the risk set. Finally, the procedure also imposed constraints on the
differences in accrued dialysis time and age at listing using pre-determined
caliper widths.</p>
<div id="example-of-a-constructed-risk-set-for-the-elas-simulator" class="section level4 unnumbered hasAnchor">
<h4>Example of a constructed risk set for the ELAS simulator<a href="APPimputation.html#example-of-a-constructed-risk-set-for-the-elas-simulator" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In Table <a href="APPimputation.html#tab:appBtab1">B.1</a> we show an example of a constructed
risk set for a patient who was transplanted, and for whom we had to
complete their status update trajectory. The first row of Table
<a href="APPimputation.html#tab:appBtab1">B.1</a> shows that this transplant recipient was listed in 2014
in Germany at an age of 64 for cirrhosis. The
patient reported a lab-MELD score equal to 33 points 36 days after
registration, and was
transplanted 6 days later. Based on our model (equation B1), the
expected log residual survival time for this patient is approximately 3.51,
which corresponds roughly to 34 days of remaining lifetime.</p>
<p>The other rows of Table <a href="APPimputation.html#tab:appBtab1">B.1</a> show 10 of the candidates
who were present in patient <span class="math inline">\(i\)</span>’s risk set <span class="math inline">\(R_i\)</span>. These patients remain at
risk 36 days after waiting list registration (<span class="math inline">\(\min(C_{k}, T_k) &gt; C_i\)</span>)
and are similar in terms of predicted expected log survival. Turning to
other characteristics, we see that the matching procedure did not match
on listing country and receival of biweekly dialysis. The risk set is
comparable in terms of continuous variables (lab-MELDs ranging from 28
to 38, ages from 53 to 69).</p>
<table class="table" style="font-size: 14px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:appBtab1">Table B.1: </span>Example of the risk set <span class="math inline">\(R_i\)</span> for a selected liver transplant recipient.
</caption>
<thead>
<tr>
<th style="text-align:left;">
year
</th>
<th style="text-align:left;">
status time <span class="math inline">\(t\)</span>
</th>
<th style="text-align:left;">
<span class="math inline">\(C_k\)</span>
</th>
<th style="text-align:left;">
<span class="math inline">\(T_k\)</span>
</th>
<th style="text-align:left;">
expected survival
</th>
<th style="text-align:left;">
lab-MELD
</th>
<th style="text-align:left;">
age
</th>
<th style="text-align:left;">
ped.
</th>
<th style="text-align:left;">
reTX
</th>
<th style="text-align:left;">
urg
</th>
<th style="text-align:left;">
(N)SE
</th>
<th style="text-align:left;">
diag.
</th>
<th style="text-align:left;">
dial.
</th>
<th style="text-align:left;">
country
</th>
</tr>
</thead>
<tbody>
<tr grouplength="1">
<td colspan="14" style="border-bottom: 1px solid;">
<strong>transplant recipient</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
2014
</td>
<td style="text-align:left;">
36.0
</td>
<td style="text-align:left;">
41.9
</td>
<td style="text-align:left;">
—
</td>
<td style="text-align:left;">
33.7
</td>
<td style="text-align:left;">
33
</td>
<td style="text-align:left;">
64
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
T
</td>
<td style="text-align:left;">
none
</td>
<td style="text-align:left;">
Cirrh.
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
DE
</td>
</tr>
<tr grouplength="10">
<td colspan="14" style="border-bottom: 1px solid;">
<strong>risk set</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
2012
</td>
<td style="text-align:left;">
40.1
</td>
<td style="text-align:left;">
46
</td>
<td style="text-align:left;">
—
</td>
<td style="text-align:left;">
32.8
</td>
<td style="text-align:left;">
34
</td>
<td style="text-align:left;">
65
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
T
</td>
<td style="text-align:left;">
none
</td>
<td style="text-align:left;">
Cirrh.
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
DE
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
2015
</td>
<td style="text-align:left;">
41.1
</td>
<td style="text-align:left;">
55.8
</td>
<td style="text-align:left;">
—
</td>
<td style="text-align:left;">
34.9
</td>
<td style="text-align:left;">
30
</td>
<td style="text-align:left;">
63
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
T
</td>
<td style="text-align:left;">
none
</td>
<td style="text-align:left;">
Cirrh.
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
DE
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
2013
</td>
<td style="text-align:left;">
40.1
</td>
<td style="text-align:left;">
47.9
</td>
<td style="text-align:left;">
—
</td>
<td style="text-align:left;">
32.4
</td>
<td style="text-align:left;">
38
</td>
<td style="text-align:left;">
56
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
T
</td>
<td style="text-align:left;">
none
</td>
<td style="text-align:left;">
Cirrh.
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
DE
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
2012
</td>
<td style="text-align:left;">
36.4
</td>
<td style="text-align:left;">
42.1
</td>
<td style="text-align:left;">
—
</td>
<td style="text-align:left;">
35.3
</td>
<td style="text-align:left;">
35
</td>
<td style="text-align:left;">
68
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
T
</td>
<td style="text-align:left;">
none
</td>
<td style="text-align:left;">
Cirrh.
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
BE
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
2010
</td>
<td style="text-align:left;">
40.2
</td>
<td style="text-align:left;">
58.9
</td>
<td style="text-align:left;">
—
</td>
<td style="text-align:left;">
35.5
</td>
<td style="text-align:left;">
28
</td>
<td style="text-align:left;">
68
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
T
</td>
<td style="text-align:left;">
none
</td>
<td style="text-align:left;">
Cirrh.
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
DE
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
2016
</td>
<td style="text-align:left;">
37.7
</td>
<td style="text-align:left;">
86.3
</td>
<td style="text-align:left;">
—
</td>
<td style="text-align:left;">
35.6
</td>
<td style="text-align:left;">
34
</td>
<td style="text-align:left;">
53
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
T
</td>
<td style="text-align:left;">
none
</td>
<td style="text-align:left;">
Cirrh.
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
DE
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
2009
</td>
<td style="text-align:left;">
41.8
</td>
<td style="text-align:left;">
—
</td>
<td style="text-align:left;">
84.8
</td>
<td style="text-align:left;">
36.3
</td>
<td style="text-align:left;">
33
</td>
<td style="text-align:left;">
53
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
T
</td>
<td style="text-align:left;">
none
</td>
<td style="text-align:left;">
Cirrh.
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
DE
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
2008
</td>
<td style="text-align:left;">
35.1
</td>
<td style="text-align:left;">
42.1
</td>
<td style="text-align:left;">
—
</td>
<td style="text-align:left;">
29.9
</td>
<td style="text-align:left;">
30
</td>
<td style="text-align:left;">
69
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
T
</td>
<td style="text-align:left;">
none
</td>
<td style="text-align:left;">
Cirrh.
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
DE
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
2012
</td>
<td style="text-align:left;">
37.3
</td>
<td style="text-align:left;">
44.9
</td>
<td style="text-align:left;">
—
</td>
<td style="text-align:left;">
38.4
</td>
<td style="text-align:left;">
37
</td>
<td style="text-align:left;">
64
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
T
</td>
<td style="text-align:left;">
none
</td>
<td style="text-align:left;">
Cirrh.
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
BE
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
2010
</td>
<td style="text-align:left;">
7.4
</td>
<td style="text-align:left;">
—
</td>
<td style="text-align:left;">
946.9
</td>
<td style="text-align:left;">
29.4
</td>
<td style="text-align:left;">
29
</td>
<td style="text-align:left;">
63
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
T
</td>
<td style="text-align:left;">
none
</td>
<td style="text-align:left;">
Cirrh.
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
AU
</td>
</tr>
</tbody>
</table>
<p></p>
<p>Within risk set <span class="math inline">\(R_i\)</span>, we can obtain a
personalized estimate of the conditional probability of the candidate <span class="math inline">\(i\)</span>’s
survival <span class="math inline">\(t\)</span> time units after their censoring time (i.e.
<span class="math inline">\(\hat{S}^{\text{IPCW}}_T(t|R_i, T &gt; C_i)\)</span>). For the 64-year-old, German
transplant candidate discussed in Table <a href="APPimputation.html#tab:appBtab1">B.1</a>, the survival function estimated using Kaplan-Meier with IPCW in their risk set <span class="math inline">\(R_i\)</span> is shown by Figure <a href="APPimputation.html#fig:chappsfig3">B.2</a>. This suggests that the 64-year old candidate with a MELD score of 33 would
have a waiting list death probability of approximately 60% in the 90 days following their censoring time.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:chappsfig3"></span>
<img src="figures/appendix/sfig3-survival_selected_riskset.png" alt="Conditional survival function, estimated with inverse probability censoring weighting for the risk set $R_i$, where $i$ is the 64-year-old German candidate appearing in Table B.1." width="50%" />
<p class="caption">
Figure B.2: Conditional survival function, estimated with inverse probability censoring weighting for the risk set <span class="math inline">\(R_i\)</span>, where <span class="math inline">\(i\)</span> is the 64-year-old German candidate appearing in Table B.1.
</p>
</div>
</div>
<div id="example-of-a-constructed-risk-set-for-the-etkidney-simulator" class="section level4 unnumbered hasAnchor">
<h4>Example of a constructed risk set for the ETKidney simulator<a href="APPimputation.html#example-of-a-constructed-risk-set-for-the-etkidney-simulator" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Table <a href="APPimputation.html#tab:appBtab2">B.2</a> shows an example of a constructed
risk set for a female candidate who was transplanted after waiting for
4.5 years for a kidney transplantation with 6 years of accrued dialysis
time in total. The first row of Table <a href="APPimputation.html#tab:appBtab2">B.2</a> shows that this
transplant recipient was listed in 2014 in Germany for polycystic kidney disease. The remaining
rows of Table <a href="APPimputation.html#tab:appBtab2">B.2</a> show 10 (out of 50) waiting list
candidates in patient <span class="math inline">\(i\)</span>’s risk set <span class="math inline">\(R_i\)</span>. These patients remain at
risk having waited 2162 days on dialysis for transplantation. They are
also similar to the patient in terms of other covariates: all matched
candidates are patients with polycystic kidney disease waiting in
Germany, and around age 60.</p>
<table class="table" style="font-size: 14px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:appBtab2">Table B.2: </span>Example of the risk set <span class="math inline">\(R_i\)</span> for a selected kidney transplant recipient. Note that matching in the ETKidney simulator
is based on dialysis vintage, not waiting time.
</caption>
<thead>
<tr>
<th style="text-align:left;">
year
</th>
<th style="text-align:left;">
waiting time
</th>
<th style="text-align:left;">
<span class="math inline">\(C_i\)</span>
</th>
<th style="text-align:left;">
<span class="math inline">\(T_i\)</span>
</th>
<th style="text-align:left;">
dialysis vintage
</th>
<th style="text-align:left;">
age
</th>
<th style="text-align:left;">
repeat transplant
</th>
<th style="text-align:left;">
urg.
</th>
<th style="text-align:left;">
diag
</th>
<th style="text-align:left;">
country
</th>
</tr>
</thead>
<tbody>
<tr grouplength="1">
<td colspan="10" style="border-bottom: 1px solid;">
<strong>Transplant recipient</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
2014
</td>
<td style="text-align:left;">
1602
</td>
<td style="text-align:left;">
1618
</td>
<td style="text-align:left;">
—
</td>
<td style="text-align:left;">
2162
</td>
<td style="text-align:left;">
64
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
T
</td>
<td style="text-align:left;">
Polycystic
</td>
<td style="text-align:left;">
DE
</td>
</tr>
<tr grouplength="10">
<td colspan="10" style="border-bottom: 1px solid;">
<strong>Risk set</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
2017
</td>
<td style="text-align:left;">
1506
</td>
<td style="text-align:left;">
2229
</td>
<td style="text-align:left;">
—
</td>
<td style="text-align:left;">
1965
</td>
<td style="text-align:left;">
62
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
T
</td>
<td style="text-align:left;">
Polycystic
</td>
<td style="text-align:left;">
DE
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
2010
</td>
<td style="text-align:left;">
1595
</td>
<td style="text-align:left;">
—
</td>
<td style="text-align:left;">
2346
</td>
<td style="text-align:left;">
2410
</td>
<td style="text-align:left;">
62
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
T
</td>
<td style="text-align:left;">
Polycystic
</td>
<td style="text-align:left;">
DE
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
2012
</td>
<td style="text-align:left;">
1635
</td>
<td style="text-align:left;">
—
</td>
<td style="text-align:left;">
2837
</td>
<td style="text-align:left;">
2495
</td>
<td style="text-align:left;">
61
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
T
</td>
<td style="text-align:left;">
Polycystic
</td>
<td style="text-align:left;">
DE
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
2014
</td>
<td style="text-align:left;">
1961
</td>
<td style="text-align:left;">
—
</td>
<td style="text-align:left;">
2619
</td>
<td style="text-align:left;">
1905
</td>
<td style="text-align:left;">
62
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
T
</td>
<td style="text-align:left;">
Polycystic
</td>
<td style="text-align:left;">
DE
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
2016
</td>
<td style="text-align:left;">
1467
</td>
<td style="text-align:left;">
—
</td>
<td style="text-align:left;">
1747
</td>
<td style="text-align:left;">
2009
</td>
<td style="text-align:left;">
59
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
T
</td>
<td style="text-align:left;">
Polycystic
</td>
<td style="text-align:left;">
DE
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
2015
</td>
<td style="text-align:left;">
1775
</td>
<td style="text-align:left;">
2255
</td>
<td style="text-align:left;">
—
</td>
<td style="text-align:left;">
2245
</td>
<td style="text-align:left;">
59
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
T
</td>
<td style="text-align:left;">
Polycystic
</td>
<td style="text-align:left;">
DE
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
2016
</td>
<td style="text-align:left;">
1464
</td>
<td style="text-align:left;">
—
</td>
<td style="text-align:left;">
—
</td>
<td style="text-align:left;">
1869
</td>
<td style="text-align:left;">
58
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
T
</td>
<td style="text-align:left;">
Polycystic
</td>
<td style="text-align:left;">
DE
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
2019
</td>
<td style="text-align:left;">
1567
</td>
<td style="text-align:left;">
—
</td>
<td style="text-align:left;">
—
</td>
<td style="text-align:left;">
2499
</td>
<td style="text-align:left;">
58
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
T
</td>
<td style="text-align:left;">
Polycystic
</td>
<td style="text-align:left;">
DE
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
2010
</td>
<td style="text-align:left;">
1459
</td>
<td style="text-align:left;">
2333
</td>
<td style="text-align:left;">
—
</td>
<td style="text-align:left;">
1991
</td>
<td style="text-align:left;">
58
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
T
</td>
<td style="text-align:left;">
Polycystic
</td>
<td style="text-align:left;">
DE
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
2011
</td>
<td style="text-align:left;">
1686
</td>
<td style="text-align:left;">
3531
</td>
<td style="text-align:left;">
—
</td>
<td style="text-align:left;">
1898
</td>
<td style="text-align:left;">
61
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
T
</td>
<td style="text-align:left;">
Polycystic
</td>
<td style="text-align:left;">
DE
</td>
</tr>
</tbody>
</table>
<p></p>
</div>
</div>
<div id="step-4.2-matching-the-patient-to-a-particular-patient-in-the-risk-set" class="section level2 hasAnchor" number="11.4">
<h2><span class="header-section-number">B.4</span> Step 4.2: Matching the patient to a particular patient in the risk set<a href="APPimputation.html#step-4.2-matching-the-patient-to-a-particular-patient-in-the-risk-set" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The aim of step 4.2 in Algorithm B.1 is to match censored patient <span class="math inline">\(i\)</span> to a single candidate <span class="math inline">\(k\)</span> from their risk set (<span class="math inline">\(k\in
R_i\)</span>). We do this by inverse transform sampling from the
risk-set-specific survival function
<span class="math inline">\(\hat{S}^{\text{IPCW}}_T(t\,|\,R_i,\, T &gt; C_i)\)</span>. Specifically, we
(i) draw a random number <span class="math inline">\(u\)</span> from the uniform distribution, and
(ii) find the smallest time <span class="math inline">\(t\)</span> such that <span class="math inline">\(\hat{S}^{\text{IPCW}}_T(t\,|\,R_i,\, T &gt; C_i) \leq u\)</span>.</p>
<p>If such a <span class="math inline">\(t\)</span> exists, it corresponds to the observed event
(removal or death) time of some patient <span class="math inline">\(k \in R_i\)</span>. We therefore
complete the status update trajectory for patient <span class="math inline">\(i\)</span> by copying
over the future status updates of this patient <span class="math inline">\(k\)</span>.</p>
<p>If no such <span class="math inline">\(t\)</span> exists within the truncation time horizon <span class="math inline">\(\tau\)</span>,
this means patient <span class="math inline">\(i\)</span> would be alive and remain waitlisted
<span class="math inline">\(\tau\)</span> days after their censoring time. In this case, we select a
candidate from those with censored restricted survival times,
i.e., from the set <span class="math inline">\(\{k \in R_i : T_k &gt; C_i + \tau\}\)</span>. Among
these, a single patient is randomly chosen with sampling
probabilities proportional to their IPCW weights at time <span class="math inline">\(\tau\)</span>.</p>
<p>We note that this procedure can also match a transplant recipient to
another patient who receives a transplant. In that case, we still
copy over all subsequent status updates from the matched candidate,
excluding the transplant event itself. In those cases, Step 4
of Algorithm B.1 is iteratively applied, until the candidate’s
registration ends with a removal (R) or death (D) status.</p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body" entry-spacing="0">
<div id="ref-SRTR2019" class="csl-entry">
<div class="csl-left-margin">[96] </div><div class="csl-right-inline">Scientific Registry of Transplant Recipients, <span>“<span>Liver Simulation Allocation Model</span> - user’s guide.”</span> 2019. Available: <a href="https://www.srtr.org/media/1361/lsam-2019-User-Guide.pdf">https://www.srtr.org/media/1361/lsam-2019-User-Guide.pdf</a></div>
</div>
<div id="ref-tayobstatistical2017" class="csl-entry">
<div class="csl-left-margin">[195] </div><div class="csl-right-inline">N. Tayob and S. Murray, <span>“Statistical consequences of a successful lung allocation system - recovering information and reducing bias in models for urgency,”</span> <em>Statistics in Medicine</em>, vol. 36, no. 15, pp. 2435–2451, 2017, doi: <a href="https://doi.org/10.1002/sim.7283">10.1002/sim.7283</a>.</div>
</div>
<div id="ref-xieqls2010" class="csl-entry">
<div class="csl-left-margin">[196] </div><div class="csl-right-inline">J. Xie, J. Shults, J. Peet, D. Stambolian, and M. F. Cotch, <span>“<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3328409">Quasi-least squares with mixed linear correlation structures</a>,”</span> <em>Statistics and its interface</em>, vol. 3, no. 2, pp. 223–234, 2010.</div>
</div>
<div id="ref-Shults2014-di" class="csl-entry">
<div class="csl-left-margin">[197] </div><div class="csl-right-inline">J. Shults and J. M. Hilbe, <em><span>Quasi-Least</span> <span>Squares</span> <span>Regression</span></em>. in Monographs on statistics &amp; applied probability. Philadelphia, PA: Chapman &amp; Hall/CRC, 2014.</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="APPipcw.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="summary.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["thesis.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
